
#imports
import pandas as pd
#Einlesen von Datein
dataframe = pd.read_csv("hotel_bookings.csv")
#clean up
dataframe ["HotelName"] = dataframe ["HotelName"] - astype("string")
dataframe ["CheckInDate"] = pd. to_datetime (dataframe ["CheckInDate"], errors="coerce")
## Astype stattdessen
dataframe = dataframe.astype({ 'HotelName': 'string', '2. bsp spalte': 'string' })
#dropping na - subset
dataframe = dataframe.dropna (subset=["CheckInDate"
', "CheckOutDate" ])
#make prices positive
dataframe ['TotalPrice'] = dataframe ['TotalPrice']. abs ()
# Only drop if ArrivalDate AND DepartureDate dont exist
flightdf = flightdf.dropna(subset=['ArrivalDate', 'DepartureDate'], how='all')
#
pop_hotels = hoteldf groupby ('HotelName') ['BookingID' ].count() - reset_index() .rename(columns=({ 'BookingID': 'Booking_Count' }))
#groupby ("HotelName"): Groups by hotel name.
#["BookingID"].count(): Counts the number of bookings for each hotel. #.reset index): Converts the grouped result back into a DataFrame.
#. rename (columns={"BookingID": "Booking Count"}): Renames the column for clarity.
print(pop_hotels [pop_hotels ['Booking_Count'] == pop_hotels[ 'Booking_Count']. max()])
#get the best one/s
#get best rated hotels
rated _hotels = customerdf groupby ('HotelName') ['Rating'] mean() reset_index()
rated_hotels = rated_hotels.sort_values(by='Rating', ascending=False)